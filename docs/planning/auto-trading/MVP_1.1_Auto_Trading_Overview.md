# MVP 1.1 자동매매 시스템 개요

## 프로젝트 상황

**현재 상태**: MVP 1.0 차트 시스템 완료
- ✅ TradingChart.tsx with lightweight-charts
- ✅ KIS API 연동 (국내/해외 주식 데이터)
- ✅ 실시간 WebSocket 인프라
- ✅ 이동평균선 (5일, 20일, 60일) 표시
- ✅ 거래량 차트 (한국식 색상)

**다음 단계**: MVP 1.1 자동매매 시스템 구축

## 시스템 비전

### 핵심 목표
사용자가 **간단한 설정**만으로 **안전한 모의투자 환경**에서 자동매매를 경험할 수 있는 시스템

### 사용자 시나리오
```
📱 사용자 A의 하루
09:00 - "삼성전자 골든크로스 전략" 설정 (투자금 100만원)
09:30 - 장 시작, 실시간 모니터링 시작
11:45 - 골든크로스 신호 발생! 📈 매수 알림
11:46 - 모의 매수 실행 (69,500원 x 14주 = 973,000원)
15:30 - 장 마감, 당일 수익률 +1.2% 확인
다음날 - 데드크로스 신호로 자동 매도
```

## MVP 1.1 범위 정의

### ✅ 포함 기능 (DO)
1. **이중 모드 지원**: 모의투자(SANDBOX) + 실전투자(LIVE) 구조적 지원
2. **종목 선택**: 국내/해외 대표 종목 선택 가능
3. **골든크로스 전략**: 5일선 > 20일선 돌파 신호
4. **실시간 모니터링**: 차트 데이터 기반 신호 감지
5. **통합 포트폴리오**: 모의/실전 통합 관리 시스템
6. **주문 기록 시스템**: DB 기반 모든 거래 내역 저장 및 추적

### ❌ 제외 기능 (DON'T)
- **실전 주문 실행** (구조는 지원, 실행만 비활성화)
- 복합 전략 (RSI, MACD 등)
- 백테스팅 (과거 데이터 시뮬레이션)
- 다중 전략 동시 실행
- 고급 리스크 관리
- AI 기반 전략
- 실시간 알림 시스템 (MVP에서는 DB 기록으로 대체)

## 기술 아키텍처

### 데이터 플로우 (실전 확장 가능)
```
실시간 차트 데이터 → 전략 엔진 → 신호 발생 → 주문 실행 엔진 → 포트폴리오 업데이트
        ↑                ↓              ↓              ↓                ↓
   KIS API (8000)    Spring Boot     DB 저장    Paper/Live 분기     DB 업데이트
                                        ↓              ↓                ↓
                                   신호 기록      모의실행/실제주문    거래 기록
```

### 이중 모드 아키텍처
```
전략 실행 요청
        ↓
거래 모드 확인 (SANDBOX/LIVE)
        ↓
┌─────────────────┬─────────────────┐
│  SANDBOX Mode   │    LIVE Mode    │
├─────────────────┼─────────────────┤
│ 가상 주문 처리   │ KIS API 주문    │
│ 가상 포트폴리오  │ 실제 포트폴리오  │
│ 시뮬레이션 수익  │ 실제 손익       │
└─────────────────┴─────────────────┘
        ↓              ↓
     DB 기록 (공통 테이블 구조)
        ↓
   사용자 대시보드
```

### 주요 컴포넌트
1. **전략 설정 UI**: Step-by-step 마법사 형태 (SANDBOX/LIVE 모드 선택)
2. **전략 엔진**: 골든크로스 계산 및 신호 생성 (Backend)
3. **통합 주문 엔진**: SANDBOX/LIVE 모드 분기 처리
4. **실시간 모니터링**: WebSocket 기반 가격 추적
5. **DB 기록 시스템**: 모든 신호/주문/포트폴리오 변경 기록
6. **KIS API 브릿지**: 실전 모드용 실제 주문 인터페이스 (구현 완료, 비활성화)

### 데이터 구조 요구사항
백엔드 담당자가 다음 요구사항에 맞춰 데이터베이스 스키마를 설계할 예정입니다:

**핵심 요구사항**:
- **거래 모드**: `LIVE` (실전투자), `SANDBOX` (모의투자) 지원
- **시장 구분**: 국내 주식 (`domestic`), 해외 주식 (`overseas`)
- **전략 관리**: 사용자별 다중 전략 운영 지원
- **신호 기록**: 모든 매매 신호와 실행 결과 추적
- **포트폴리오**: LIVE/SANDBOX 모드별 독립적인 포트폴리오 관리
- **주문 기록**: 알림 시스템 대신 DB 기반 주문 상태 관리

**필수 데이터 엔티티**:
- 자동매매 전략 설정
- 매매 신호 발생 기록
- 주문 실행 결과
- 포트폴리오 현황
- 사용자별 전략 관리

## 사용자 인터페이스

### 전략 설정 화면
```
┌─────────────────────────────────────┐
│ 🎯 자동매매 전략 만들기              │
├─────────────────────────────────────┤
│                                     │
│ 1️⃣ 거래 모드 선택                  │
│    ◯ 📊 모의투자 (SANDBOX)         │
│    ◯ 💰 실전투자 (LIVE)            │
│    ⚠️ 실전 모드는 실제 자금이 필요   │
│                                     │
│ 2️⃣ 시장 선택                       │
│    ◯ 국내 주식  ◯ 해외 주식         │
│                                     │
│ 3️⃣ 종목 선택                       │
│    [🔍 종목 검색]                   │
│    선택: 005930 삼성전자             │
│                                     │
│ 4️⃣ 전략 선택                       │
│    [📈 골든크로스] (5일선 > 20일선)  │
│    📝 간단하고 안전한 추세 전략      │
│                                     │
│ 5️⃣ 투자 설정                       │
│    💰 투자금액: [1,000,000]원       │
│    📉 손절률: [-5]%                 │
│    🔒 모의투자 시 가상 자금 사용     │
│                                     │
│ [전략 시작하기] 버튼                 │
│ 💡 모의투자로 먼저 테스트 권장       │
└─────────────────────────────────────┘
```

### 모니터링 대시보드
```
┌─────────────────────────────────────┐
│ 📊 내 자동매매 전략                  │
├─────────────────────────────────────┤
│ [🟢 활성] 삼성전자 골든크로스         │
│ 📊 SANDBOX | 수익률: +1.2% (+12,000원) │
│ 📊 보유: 14주 × 70,350원            │
│ ⏰ 마지막 체크: 2분 전              │
│ 🔄 실시간 감지 중...               │
│                                     │
│ [일시정지] [실전전환] [설정변경] [종료] │
├─────────────────────────────────────┤
│ 📋 주문 기록 (DB 저장)              │
│ • 11:45 매수 완료 (골든크로스)       │
│   가격: 69,500원 | 수량: 14주       │
│ • 전일 14:20 매도 완료 (데드크로스)  │
│   가격: 70,850원 | 수량: 14주       │
│                                     │
│ 💡 모든 거래 기록이 DB에 저장됨      │
└─────────────────────────────────────┘
```

## 성공 지표

### 기술적 목표
- **신호 정확도**: 골든크로스/데드크로스 감지 정확도 95% 이상
- **응답 속도**: 신호 발생 후 5초 이내 알림 전송
- **시스템 안정성**: 장중 무중단 모니터링 (99% 가용성)

### 사용자 경험 목표
- **설정 완료**: 3분 이내 전략 설정 완료
- **이해도**: 초보자도 쉽게 이해할 수 있는 직관적 UI
- **신뢰도**: 모의투자 결과의 정확성과 투명성

## 다음 단계 계획

### MVP 1.2 (확장 기능)
- **다중 전략**: RSI, MACD 등 추가 전략
- **백테스팅**: 과거 데이터로 전략 검증
- **복합 조건**: 여러 지표 조합 전략

### MVP 1.3 (실전 준비)
- **실전 모드**: 실제 KIS API 주문 연동
- **리스크 관리**: 포지션 사이징, 최대 손실 한계
- **성과 분석**: 상세 수익률 분석 및 리포팅

### MVP 2.0 (고도화)
- **AI 전략**: 머신러닝 기반 매매 신호
- **포트폴리오 최적화**: 다종목 자동 분산 투자
- **소셜 트레이딩**: 전략 공유 및 copy trading

## 개발 우선순위

### Week 1: 기본 인프라
1. 전략 설정 UI 구현
2. 데이터베이스 스키마 생성
3. 기본 API 엔드포인트 구현

### Week 2: 핵심 로직
1. 골든크로스 계산 엔진
2. 모의투자 실행 로직
3. 실시간 모니터링 시스템

### Week 3: 사용자 경험
1. 알림 시스템 구현
2. 대시보드 UI 완성
3. 통합 테스트 및 최적화

이렇게 단계적으로 구현하여 **안전하고 실용적인 자동매매 시스템**을 완성하겠습니다.