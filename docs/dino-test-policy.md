# 디노테스트 (DINO Test) 정책 문서

## 개요

디노테스트는 주식 종목의 종합적인 투자 가치를 평가하는 시스템으로, 재무/기술/가격/재료 4개 영역을 분석하여 점수를 산정합니다.

- **통과 기준**: 15점 이상
- **평가 영역**: 재무(5점) + 기술(4점) + 가격(2점) + 재료(4점) = **총 15점**
- **활용**: 자동매매 시스템의 종목 선별 필터

## 1. 재무 영역 (5점 만점)

재무 영역은 **-5점 ~ +5점** 범위에서 평가되며, 음수 점수도 가능합니다.

### 1.1 매출액 증감 (±1점)
- **전년 대비 매출 증가 10% 이상**: +1점
- **전년 대비 매출 감소**: -1점
- **나머지 경우**: 0점

**계산식**: `(당년 매출액 - 전년 매출액) / 전년 매출액 × 100`

### 1.2 영업이익 상태 (±2점)
- **영업이익 흑자 전환** (전년 적자 → 당년 흑자): +1점
- **영업이익 적자 전환** (전년 흑자 → 당년 적자): -1점
- **영업이익 적자 지속** (전년 적자 → 당년 적자): -2점
- **영업이익 흑자 지속**: 0점

### 1.3 영업이익률 (+1점)
- **영업이익률 10% 이상**: +1점
- **나머지 경우**: 0점

**계산식**: `영업이익 / 매출액 × 100`

### 1.4 유보율 (±1점)
- **유보율 1,000% 이상**: +1점
- **유보율 300% 이하**: -1점
- **나머지 경우**: 0점

**계산식**: `이익잉여금 / 자본금 × 100`

### 1.5 부채비율 (±1점)
- **부채비율 50% 이하**: +1점
- **부채비율 200% 이상**: -1점
- **나머지 경우**: 0점

**계산식**: `총부채 / 자기자본 × 100`

## 2. 기술 영역 (4점 만점)

### 2.1 OBV (On-Balance Volume) - 1점
- **2년간 OBV 조건 만족**: +1점
- **조건 불만족**: 0점

**평가 기준**: 2년간 OBV 추세가 상승세를 유지하는 경우

### 2.2 RSI (Relative Strength Index) - 1점
- **평가 기준**: TBD (추후 정의)

### 2.3 투자심리도 - 1점
- **투자심리도 25% 이하 (침체 구간)**: +1점
- **나머지 경우**: 0점

### 2.4 기타 기술지표 - 1점
- **평가 기준**: TBD (추후 정의)

## 3. 가격 영역 (2점 만점)

### 3.1 가격 위치 평가
- **52주 고점 대비 위치**
- **52주 저점 대비 위치**

**평가 기준**: TBD (추후 정의)

## 4. 재료 영역 (4점 만점)

### 4.1 배당률 - 1점
- **배당률 2% 이상**: +1점
- **나머지 경우**: 0점

### 4.2 어닝서프라이즈 - 1점
- **컨센서스 대비 10% 이상 실적**: +1점
- **나머지 경우**: 0점

### 4.3 기관/외인 매집 - 1점
- **60일 기관 순매매량 또는 외인 순매매량 매집 신호**: +1점
- **나머지 경우**: 0점

### 4.4 테마/재료 - 1점
- **확실한 주도 테마 보유**: +1점
- **나머지 경우**: 0점

## 5. 데이터 소스 요구사항

### 5.1 재무 데이터
- **필요 데이터**: 매출액, 영업이익, 영업이익률, 유보율, 부채비율
- **데이터 주기**: 분기별 (최신 2개 분기 또는 연간 비교)
- **KIS Open API 소스**:
  - `finance_income_statement` - 손익계산서 (매출액, 영업이익 데이터)
    - API URL: `/uapi/domestic-stock/v1/finance/income-statement`
    - TR ID: `FHKST66430200`
    - 매개변수: `fid_div_cls_code` (0: 년, 1: 분기), `fid_input_iscd` (종목코드)
  - `finance_balance_sheet` - 대차대조표 (총부채, 자기자본, 이익잉여금 데이터)
    - API URL: `/uapi/domestic-stock/v1/finance/balance-sheet`
    - TR ID: `FHKST66430100`
    - 매개변수: `fid_div_cls_code` (0: 년, 1: 분기), `fid_input_iscd` (종목코드)
  - `finance_financial_ratio` - 재무비율 (영업이익률 등 계산된 비율)
    - API URL: `/uapi/domestic-stock/v1/finance/financial-ratio`
    - TR ID: `FHKST66430300`
  - `finance_stability_ratio` - 안정성비율 (부채비율 등 안정성 지표)
    - API URL: `/uapi/domestic-stock/v1/finance/stability-ratio`
    - TR ID: `FHKST66430600`
  - `finance_growth_ratio` - 성장성비율 (매출 성장률 등)
    - API URL: `/uapi/domestic-stock/v1/finance/growth-ratio`
    - TR ID: `FHKST66430800`
- **대체 데이터 소스**:
  - DART 공시 시스템 (외부 어댑터 연동)
  - 네이버 금융 API
  - 한국거래소 API

### 5.2 기술 데이터
- **필요 데이터**: OBV, RSI, 투자심리도, 이동평균선
- **데이터 주기**: 일별
- **KIS Open API 소스**:
  - `inquire_daily_itemchartprice` - 일봉 차트 데이터 (OHLCV)
    - API URL: `/uapi/domestic-stock/v1/quotations/inquire-daily-itemchartprice`
    - TR ID: `FHKST03010100`
    - 매개변수: `fid_input_iscd` (종목코드), `fid_period_div_code` (D:일봉)
    - **OBV 계산**: 거래량 데이터로 On-Balance Volume 계산
    - **RSI 계산**: 일봉 가격 데이터로 Relative Strength Index 계산
  - `inquire_index_price` - 지수 데이터 (투자심리도 계산용)
    - API URL: `/uapi/domestic-stock/v1/quotations/inquire-index-price`
    - KOSPI 지수 추세로 투자심리도 분석
- **기술 지표 계산**:
  - pandas-ta 라이브러리 활용
  - PyKRX (한국거래소 직접 데이터)
  - yfinance (글로벌 데이터)

### 5.3 가격 데이터
- **필요 데이터**: 현재가, 52주 고가/저가
- **데이터 주기**: 실시간
- **KIS Open API 소스**:
  - `inquire_price` - 현재가 조회
    - API URL: `/uapi/domestic-stock/v1/quotations/inquire-price`
    - TR ID: `FHKST01010100`
    - 52주 고가/저가 포함된 상세 시세 데이터
  - `inquire_daily_itemchartprice` - 일봉 차트로 52주 범위 계산
    - 1년 치 일봉 데이터로 52주 고가/저가 계산
- **가격 위치 계산**:
  - 현재가 vs 52주 고가/저가 비율 계산
  - 상대적 가격 위치 퍼센타일 분석

### 5.4 재료 데이터
- **필요 데이터**: 배당률, 실적 컨센서스, 기관/외인 매매 데이터, 테마 정보
- **데이터 주기**: 일별/주별
- **KIS Open API 소스**:
  - `inquire_investor` - 투자자별 매매 정보 (기관/외인 데이터)
    - API URL: `/uapi/domestic-stock/v1/quotations/inquire-investor`
    - TR ID: `FHKST01010900`
    - 개인/기관/외국인 투자자별 매매 데이터
    - 60일 기간 순매매량 추세 분석
  - `finance_financial_ratio` - 배당률 등 재무 비율
    - 배당수익률, PER, PBR 등 투자 지표
- **외부 데이터 소스**:
  - DART 공시 시스템 (실적 발표, 컨센서스)
  - 네이버 뉴스 API (테마/재료 분석)
  - 증권사 리서치 API (컨센서스 데이터)

## 6. 자동매매 연동 정책

### 6.1 종목 선별 기준
디노테스트 **15점 이상** 통과 종목만 자동매매 대상으로 선정

### 6.2 매수 조건
**옵션 1: 시장상황 고려 O**
```
전제: 디노테스트 15점 이상 + 시장 상승장
시장 조건: KOSPI 20일선 > 50일선 AND 종가 > 200일선
매수 조건: ADR ≥ 100 AND OBV ≥ 100 AND SMA5 > SMA200
```

**옵션 2: 시장상황 고려 X**
```
전제: 디노테스트 15점 이상
매수 조건: ADR ≥ 100 AND OBV ≥ 100 AND SMA5 > SMA200
```

### 6.3 매도 조건 (OR 조건)
다음 조건 중 **1개 이상** 감지 시 매도:

**손익 기준**
- +10% 이상 도달 시 익절
- -5% 도달 시 손절

**시장 상황**
- KOSPI 20일선 < 50일선

**기술적 시그널**
- 5일선이 20일선 도달
- 5일선이 120일선 도달
- OBV가 직전 20일 평균 대비 50% 이하로 급감
- RSI ≥ 70 (과열)

## 7. 백테스팅 정책

### 7.1 테스트 기간
- 일주일
- 한 달
- 6개월
- 1년
- 2년

### 7.2 성과 지표
- 수익률
- 샤프 비율
- 최대 낙폭 (MDD)
- 승률
- 평균 보유 기간

## 8. 시스템 구현 우선순위

### Phase 1: 재무 영역 구현
1. 데이터 소스 조사 및 연동
2. 재무 지표 계산 엔진 구현
3. 테스트 및 검증

### Phase 2: 기술 영역 구현
1. 기술 지표 계산 엔진 구현
2. OBV, RSI, 투자심리도 평가 로직
3. 테스트 및 검증

### Phase 3: 가격/재료 영역 구현
1. 가격 위치 평가 로직
2. 재료 지표 수집 및 평가
3. 통합 테스트

### Phase 4: 자동매매 연동
1. 매수/매도 조건 엔진 구현
2. 실시간 모니터링 시스템
3. 백테스팅 시스템

---

**문서 버전**: 1.0  
**최종 수정일**: 2025년 1월 9일  
**작성자**: Quantum Trading Platform Team