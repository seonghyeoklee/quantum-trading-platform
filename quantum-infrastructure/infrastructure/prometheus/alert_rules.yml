groups:
  # í•µì‹¬ ì‹œìŠ¤í…œ ì•Œë¦¼
  - name: quantum-system-alerts
    rules:
      # ì„œë¹„ìŠ¤ ë‹¤ìš´ ì•Œë¦¼
      - alert: ServiceDown
        expr: up{job=~"quantum-.*"} == 0
        for: 30s
        labels:
          severity: critical
          service: "{{ $labels.job }}"
        annotations:
          summary: "ğŸš¨ {{ $labels.job }} ì„œë¹„ìŠ¤ ì¤‘ë‹¨"
          description: "{{ $labels.job }} ì„œë¹„ìŠ¤ê°€ 30ì´ˆ ì´ìƒ ì‘ë‹µí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì¦‰ì‹œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."
      
      # ì„œë¹„ìŠ¤ ë³µêµ¬ ì•Œë¦¼
      - alert: ServiceRecovered
        expr: up{job=~"quantum-.*"} == 1
        for: 30s
        labels:
          severity: info
          service: "{{ $labels.job }}"
        annotations:
          summary: "âœ… {{ $labels.job }} ì„œë¹„ìŠ¤ ë³µêµ¬"
          description: "{{ $labels.job }} ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ë³µêµ¬ë˜ì—ˆìŠµë‹ˆë‹¤."

  # HTTP ì„±ëŠ¥ ë° ì—ëŸ¬ ì•Œë¦¼
  - name: quantum-http-alerts
    rules:
      # ë†’ì€ ì—ëŸ¬ìœ¨ (Critical)
      - alert: CriticalErrorRate
        expr: (rate(http_server_requests_seconds_count{status=~"5.."}[5m]) / rate(http_server_requests_seconds_count[5m])) > 0.25
        for: 2m
        labels:
          severity: critical
          service: "{{ $labels.job }}"
        annotations:
          summary: "ğŸ”¥ {{ $labels.job }} ì‹¬ê°í•œ ì—ëŸ¬ìœ¨"
          description: "{{ $labels.job }}ì—ì„œ 5ë¶„ê°„ HTTP 5xx ì—ëŸ¬ìœ¨ì´ 25%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ë†’ì€ ì—ëŸ¬ìœ¨ (Warning)
      - alert: HighErrorRate
        expr: (rate(http_server_requests_seconds_count{status=~"5.."}[5m]) / rate(http_server_requests_seconds_count[5m])) > 0.1
        for: 5m
        labels:
          severity: warning
          service: "{{ $labels.job }}"
        annotations:
          summary: "âš ï¸ {{ $labels.job }} ë†’ì€ ì—ëŸ¬ìœ¨"
          description: "{{ $labels.job }}ì—ì„œ 5ë¶„ê°„ HTTP 5xx ì—ëŸ¬ìœ¨ì´ 10%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ì‘ë‹µ ì‹œê°„ ì§€ì—° (Critical)
      - alert: CriticalResponseTime
        expr: histogram_quantile(0.95, rate(http_server_requests_seconds_bucket[5m])) > 5.0
        for: 2m
        labels:
          severity: critical
          service: "{{ $labels.job }}"
        annotations:
          summary: "ğŸ”¥ {{ $labels.job }} ì‹¬ê°í•œ ì‘ë‹µ ì§€ì—°"
          description: "{{ $labels.job }}ì˜ 95th percentile ì‘ë‹µì‹œê°„ì´ 5ì´ˆë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}ì´ˆ)"
      
      # ì‘ë‹µ ì‹œê°„ ì§€ì—° (Warning)
      - alert: HighResponseTime
        expr: histogram_quantile(0.95, rate(http_server_requests_seconds_bucket[5m])) > 2.0
        for: 5m
        labels:
          severity: warning
          service: "{{ $labels.job }}"
        annotations:
          summary: "âš ï¸ {{ $labels.job }} ì‘ë‹µ ì§€ì—°"
          description: "{{ $labels.job }}ì˜ 95th percentile ì‘ë‹µì‹œê°„ì´ 2ì´ˆë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}ì´ˆ)"

  # ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤ ì•Œë¦¼
  - name: quantum-resource-alerts
    rules:
      # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ë†’ìŒ (Critical)
      - alert: CriticalMemoryUsage
        expr: (container_memory_usage_bytes{name=~"quantum-.*"} / container_spec_memory_limit_bytes{name=~"quantum-.*"}) > 0.95
        for: 2m
        labels:
          severity: critical
          container: "{{ $labels.name }}"
        annotations:
          summary: "ğŸ”¥ {{ $labels.name }} ë©”ëª¨ë¦¬ ìœ„í—˜"
          description: "{{ $labels.name }} ì»¨í…Œì´ë„ˆì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 95%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ë†’ìŒ (Warning)
      - alert: HighMemoryUsage
        expr: (container_memory_usage_bytes{name=~"quantum-.*"} / container_spec_memory_limit_bytes{name=~"quantum-.*"}) > 0.85
        for: 5m
        labels:
          severity: warning
          container: "{{ $labels.name }}"
        annotations:
          summary: "âš ï¸ {{ $labels.name }} ë†’ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©"
          description: "{{ $labels.name }} ì»¨í…Œì´ë„ˆì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 85%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # CPU ì‚¬ìš©ë¥  ë†’ìŒ (Warning)
      - alert: HighCpuUsage
        expr: rate(container_cpu_usage_seconds_total{name=~"quantum-.*"}[5m]) * 100 > 80
        for: 10m
        labels:
          severity: warning
          container: "{{ $labels.name }}"
        annotations:
          summary: "âš ï¸ {{ $labels.name }} ë†’ì€ CPU ì‚¬ìš©ë¥ "
          description: "{{ $labels.name }} ì»¨í…Œì´ë„ˆì˜ CPU ì‚¬ìš©ë¥ ì´ 80%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}%)"

  # ë°ì´í„°ë² ì´ìŠ¤ ì•Œë¦¼
  - name: quantum-database-alerts
    rules:
      # PostgreSQL ì—°ê²° ìˆ˜ ë†’ìŒ
      - alert: HighPostgreSQLConnections
        expr: pg_stat_database_numbackends{datname="quantum_trading"} > 50
        for: 5m
        labels:
          severity: warning
          database: "postgresql"
        annotations:
          summary: "âš ï¸ PostgreSQL ë†’ì€ ì—°ê²° ìˆ˜"
          description: "PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ì˜ í™œì„± ì—°ê²°ì´ 50ê°œë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}ê°œ)"
      
      # Redis ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ë†’ìŒ
      - alert: HighRedisMemoryUsage
        expr: (redis_memory_used_bytes / redis_config_maxmemory) > 0.9
        for: 5m
        labels:
          severity: warning
          database: "redis"
        annotations:
          summary: "âš ï¸ Redis ë†’ì€ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ "
          description: "Redisì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ 90%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # Redis ìºì‹œ íˆíŠ¸ìœ¨ ë‚®ìŒ
      - alert: LowRedisCacheHitRate
        expr: (redis_keyspace_hits_total / (redis_keyspace_hits_total + redis_keyspace_misses_total)) < 0.8
        for: 10m
        labels:
          severity: warning
          database: "redis"
        annotations:
          summary: "âš ï¸ Redis ë‚®ì€ ìºì‹œ íˆíŠ¸ìœ¨"
          description: "Redis ìºì‹œ íˆíŠ¸ìœ¨ì´ 80% ë¯¸ë§Œì…ë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"

  # Kafka ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì•Œë¦¼
  - name: quantum-kafka-alerts
    rules:
      # Consumer Lag ë†’ìŒ (Critical)
      - alert: CriticalKafkaConsumerLag
        expr: kafka_consumer_lag_sum > 1000
        for: 2m
        labels:
          severity: critical
          service: "kafka"
          topic: "{{ $labels.topic }}"
        annotations:
          summary: "ğŸ”¥ Kafka Consumer Lag ì‹¬ê°"
          description: "{{ $labels.topic }} í† í”½ì˜ Consumer Lagì´ 1000ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }})"
      
      # Consumer Lag ë†’ìŒ (Warning)
      - alert: HighKafkaConsumerLag
        expr: kafka_consumer_lag_sum > 500
        for: 5m
        labels:
          severity: warning
          service: "kafka"
          topic: "{{ $labels.topic }}"
        annotations:
          summary: "âš ï¸ Kafka Consumer Lag ë†’ìŒ"
          description: "{{ $labels.topic }} í† í”½ì˜ Consumer Lagì´ 500ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }})"

  # ë¹„ì¦ˆë‹ˆìŠ¤ ë©”íŠ¸ë¦­ ì•Œë¦¼
  - name: quantum-business-alerts
    rules:
      # ê±°ë˜ ì²˜ë¦¬ ì‹¤íŒ¨ìœ¨ ë†’ìŒ
      - alert: HighTradingFailureRate
        expr: (rate(quantum_trading_orders_total{status="failed"}[5m]) / rate(quantum_trading_orders_total[5m])) > 0.05
        for: 3m
        labels:
          severity: warning
          type: "business"
        annotations:
          summary: "âš ï¸ ë†’ì€ ê±°ë˜ ì‹¤íŒ¨ìœ¨"
          description: "ê±°ë˜ ì£¼ë¬¸ ì‹¤íŒ¨ìœ¨ì´ 5%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ì‹œì¥ ë°ì´í„° ì§€ì—°
      - alert: HighMarketDataLatency
        expr: histogram_quantile(0.95, rate(quantum_market_data_latency_seconds_bucket[5m])) > 0.5
        for: 5m
        labels:
          severity: warning
          type: "business"
        annotations:
          summary: "âš ï¸ ì‹œì¥ ë°ì´í„° ì§€ì—°"
          description: "ì‹œì¥ ë°ì´í„° ì²˜ë¦¬ ì§€ì—°ì‹œê°„ì´ 500msë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizeDuration }})"
      
      # ê±°ë˜ëŸ‰ ê¸‰ê° ê°ì§€
      - alert: LowTradingVolume
        expr: rate(quantum_trading_orders_total[10m]) < 0.1
        for: 15m
        labels:
          severity: info
          type: "business"
        annotations:
          summary: "â„¹ï¸ ë‚®ì€ ê±°ë˜ëŸ‰"
          description: "10ë¶„ê°„ í‰ê·  ê±°ë˜ëŸ‰ì´ ë¶„ë‹¹ 0.1ê±´ ë¯¸ë§Œì…ë‹ˆë‹¤. ì‹œìŠ¤í…œ ì ê²€ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

  # ë¡œê·¸ ê¸°ë°˜ ì•Œë¦¼
  - name: quantum-log-alerts
    rules:
      # ë†’ì€ ë¡œê·¸ ì—ëŸ¬ìœ¨ (Critical)
      - alert: CriticalLogErrorRate
        expr: (rate(log_errors_total[5m]) / rate(log_entries_total[5m])) > 0.1
        for: 2m
        labels:
          severity: critical
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "ğŸ”¥ {{ $labels.service }} ì‹¬ê°í•œ ë¡œê·¸ ì—ëŸ¬ìœ¨"
          description: "{{ $labels.service }}ì—ì„œ 5ë¶„ê°„ ë¡œê·¸ ì—ëŸ¬ìœ¨ì´ 10%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ë¡œê·¸ ì—ëŸ¬ ê¸‰ì¦ (Warning)
      - alert: HighLogErrorCount
        expr: rate(log_errors_total[5m]) > 0.5
        for: 3m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "âš ï¸ {{ $labels.service }} ë¡œê·¸ ì—ëŸ¬ ê¸‰ì¦"
          description: "{{ $labels.service}}ì—ì„œ ë¶„ë‹¹ 0.5ê°œ ì´ìƒì˜ ì—ëŸ¬ ë¡œê·¸ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}/ë¶„)"
      
      # HTTP 4xx ì—ëŸ¬ ê¸‰ì¦
      - alert: HighHttp4xxErrorLogs
        expr: rate(http_requests_log_total{http_status=~"4.."}[5m]) > 2.0
        for: 5m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "âš ï¸ {{ $labels.service }} HTTP 4xx ì—ëŸ¬ ê¸‰ì¦"
          description: "{{ $labels.service }}ì—ì„œ ë¶„ë‹¹ 2ê±´ ì´ìƒì˜ 4xx HTTP ì—ëŸ¬ê°€ ë¡œê·¸ì— ê¸°ë¡ë˜ê³  ìˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}/ë¶„)"
      
      # HTTP 5xx ì—ëŸ¬ ë°œìƒ (Critical)
      - alert: CriticalHttp5xxErrorLogs
        expr: rate(http_requests_log_total{http_status=~"5.."}[5m]) > 0.1
        for: 1m
        labels:
          severity: critical
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "ğŸ”¥ {{ $labels.service }} HTTP 5xx ì„œë²„ ì—ëŸ¬"
          description: "{{ $labels.service }}ì—ì„œ 5xx ì„œë²„ ì—ëŸ¬ê°€ ë¡œê·¸ì— ê¸°ë¡ë˜ê³  ìˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}/ë¶„)"
      
      # Exception/Error íŒ¨í„´ ê°ì§€
      - alert: ApplicationExceptionDetected
        expr: rate(log_errors_total{error_type=~"Exception|Error"}[2m]) > 0
        for: 30s
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "âš ï¸ {{ $labels.service }} ì• í”Œë¦¬ì¼€ì´ì…˜ ì˜ˆì™¸ ë°œìƒ"
          description: "{{ $labels.service }}ì—ì„œ {{ $labels.error_type }}ì´(ê°€) ë¡œê·¸ì—ì„œ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤."
      
      # ë¡œê·¸ ìˆ˜ì§‘ ì¤‘ë‹¨ ê°ì§€
      - alert: LogCollectionDown
        expr: absent_over_time(log_entries_total[5m])
        for: 2m
        labels:
          severity: critical
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "ğŸš¨ {{ $labels.service }} ë¡œê·¸ ìˆ˜ì§‘ ì¤‘ë‹¨"
          description: "{{ $labels.service }}ì—ì„œ 5ë¶„ ì´ìƒ ë¡œê·¸ê°€ ìˆ˜ì§‘ë˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. Promtail ë˜ëŠ” ë¡œê·¸ íŒŒì´í”„ë¼ì¸ ì ê²€ì´ í•„ìš”í•©ë‹ˆë‹¤."

  # ê³ ê¸‰ ë¡œê·¸ ë¶„ì„ ì•Œë¦¼
  - name: quantum-advanced-log-alerts
    rules:
      # SQL ì—ëŸ¬ ê¸‰ì¦ ê°ì§€
      - alert: SQLErrorSpike
        expr: rate(sql_errors_total[5m]) > 0.2
        for: 2m
        labels:
          severity: critical
          service: "{{ $labels.service }}"
          type: "logs"
          database: "sql"
        annotations:
          summary: "ğŸ—„ï¸ {{ $labels.service }} SQL ì—ëŸ¬ ê¸‰ì¦"
          description: "{{ $labels.service }}ì—ì„œ ë¶„ë‹¹ 0.2ê±´ ì´ìƒì˜ SQL ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë˜ëŠ” ì¿¼ë¦¬ë¥¼ ì ê²€í•´ì£¼ì„¸ìš”."
      
      # ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ê¸‰ì¦ ê°ì§€
      - alert: NetworkErrorSpike
        expr: rate(network_errors_total[5m]) > 0.3
        for: 3m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "logs"
          category: "network"
        annotations:
          summary: "ğŸŒ {{ $labels.service }} ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ê¸‰ì¦"
          description: "{{ $labels.service }}ì—ì„œ ë¶„ë‹¹ 0.3ê±´ ì´ìƒì˜ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì™¸ë¶€ ì„œë¹„ìŠ¤ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”."
      
      # ì¸ì¦/ê¶Œí•œ ì—ëŸ¬ íŒ¨í„´ ê°ì§€
      - alert: AuthenticationFailureSpike
        expr: rate(auth_errors_total[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "logs"
          category: "security"
        annotations:
          summary: "ğŸ” {{ $labels.service }} ì¸ì¦ ì‹¤íŒ¨ ê¸‰ì¦"
          description: "{{ $labels.service }}ì—ì„œ ë¶„ë‹¹ 0.1ê±´ ì´ìƒì˜ ì¸ì¦/ê¶Œí•œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë³´ì•ˆ ì‚¬ê³  ê°€ëŠ¥ì„±ì„ ì ê²€í•´ì£¼ì„¸ìš”."
      
      # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—ëŸ¬ ê¸‰ì¦
      - alert: BusinessLogicErrorSpike
        expr: rate(business_errors_total[5m]) > 0.15
        for: 3m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "business"
        annotations:
          summary: "ğŸ’¼ {{ $labels.service }} ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—ëŸ¬ ê¸‰ì¦"
          description: "{{ $labels.service }}ì—ì„œ ë¶„ë‹¹ 0.15ê±´ ì´ìƒì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—ëŸ¬ê°€ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ê±°ë˜ ì²˜ë¦¬ ë¡œì§ì„ ì ê²€í•´ì£¼ì„¸ìš”."
      
      # íŠ¹ì • API ì—”ë“œí¬ì¸íŠ¸ ì—ëŸ¬ ê¸‰ì¦
      - alert: APIEndpointErrorSpike
        expr: |
          (
            sum by (api_endpoint, service) (rate(business_errors_total[5m])) +
            sum by (api_endpoint, service) (rate(sql_errors_total[5m])) +
            sum by (api_endpoint, service) (rate(network_errors_total[5m]))
          ) /
          sum by (api_endpoint, service) (rate(api_requests_log_total[5m])) > 0.05
        for: 2m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          api_endpoint: "{{ $labels.api_endpoint }}"
          type: "logs"
        annotations:
          summary: "ğŸ¯ API {{ $labels.api_endpoint }} ì—ëŸ¬ìœ¨ ê¸‰ì¦"
          description: "API /{{ $labels.api_endpoint }}ì—ì„œ ì—ëŸ¬ìœ¨ì´ 5%ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value | humanizePercentage }})"
      
      # ì—ëŸ¬ ì¹´í…Œê³ ë¦¬ ë¶ˆê· í˜• ê°ì§€ (í•œ ì¹´í…Œê³ ë¦¬ê°€ ì „ì²´ì˜ 80% ì´ìƒ)
      - alert: ErrorCategoryImbalance
        expr: |
          (
            max by (service) (rate(sql_errors_total[5m])) or
            max by (service) (rate(network_errors_total[5m])) or
            max by (service) (rate(auth_errors_total[5m])) or
            max by (service) (rate(business_errors_total[5m]))
          ) / 
          sum by (service) (rate(error_categories_total[5m])) > 0.8
        for: 5m
        labels:
          severity: info
          service: "{{ $labels.service }}"
          type: "logs"
        annotations:
          summary: "ğŸ“Š {{ $labels.service }} ì—ëŸ¬ íŒ¨í„´ í¸ì¤‘"
          description: "{{ $labels.service }}ì—ì„œ íŠ¹ì • ì—ëŸ¬ ì¹´í…Œê³ ë¦¬ê°€ ì „ì²´ ì—ëŸ¬ì˜ 80% ì´ìƒì„ ì°¨ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê·¼ë³¸ ì›ì¸ ë¶„ì„ì´ í•„ìš”í•©ë‹ˆë‹¤."
      
      # ì‚¬ìš©ì í™œë™ ê¸‰ê° ê°ì§€
      - alert: UserActivityDropoff
        expr: |
          (
            sum(rate(user_actions_total[5m])) < 
            sum(rate(user_actions_total[1h] offset 1h)) * 0.3
          )
        for: 10m
        labels:
          severity: warning
          type: "business"
        annotations:
          summary: "ğŸ‘¥ ì‚¬ìš©ì í™œë™ ê¸‰ê°"
          description: "í˜„ì¬ ì‚¬ìš©ì í™œë™ì´ 1ì‹œê°„ ì „ ëŒ€ë¹„ 70% ì´ìƒ ê°ì†Œí–ˆìŠµë‹ˆë‹¤. ì‹œìŠ¤í…œ ì¥ì•  ë˜ëŠ” ì„œë¹„ìŠ¤ ì´ìŠˆë¥¼ ì ê²€í•´ì£¼ì„¸ìš”."
      
      # API ì‘ë‹µì‹œê°„ ë¡œê·¸ ê¸°ë°˜ ì§€ì—° ê°ì§€
      - alert: APIResponseTimeFromLogs
        expr: histogram_quantile(0.95, rate(api_response_time_log_bucket[5m])) > 2000
        for: 3m
        labels:
          severity: warning
          service: "{{ $labels.service }}"
          type: "performance"
        annotations:
          summary: "â±ï¸ {{ $labels.service }} ë¡œê·¸ ê¸°ë°˜ ì‘ë‹µì‹œê°„ ì§€ì—°"
          description: "ë¡œê·¸ì—ì„œ ì¶”ì¶œí•œ P95 ì‘ë‹µì‹œê°„ì´ 2ì´ˆë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. (í˜„ì¬: {{ $value }}ms)"
      
      # ê±°ë˜ ID ê¸°ë°˜ ë¬¸ì œ ê±°ë˜ ê°ì§€
      - alert: ProblematicTradingPattern
        expr: |
          sum by (trade_id) (rate(business_errors_total[5m])) > 0
          and
          sum by (trade_id) (rate(trading_events_total[5m])) > 0.1
        for: 1m
        labels:
          severity: critical
          trade_id: "{{ $labels.trade_id }}"
          type: "business"
        annotations:
          summary: "ğŸ’° ë¬¸ì œ ê±°ë˜ íŒ¨í„´ ê°ì§€"
          description: "ê±°ë˜ ID {{ $labels.trade_id }}ì—ì„œ ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ì„œ ë™ì‹œì— ë†’ì€ í™œë™ì„ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. ì¦‰ì‹œ ì ê²€ì´ í•„ìš”í•©ë‹ˆë‹¤."

  # ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ (ìˆ˜ë™ íŠ¸ë¦¬ê±°ìš©)
  - name: quantum-test-alerts
    rules:
      - alert: TestAlert
        expr: prometheus_build_info > 0
        for: 0s
        labels:
          severity: info
          type: "test"
        annotations:
          summary: "ğŸ§ª Quantum Trading Platform - í…ŒìŠ¤íŠ¸ ì•Œë¦¼"
          description: "ì´ê²ƒì€ ì•Œë¦¼ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ìš© ì•Œë¦¼ì…ë‹ˆë‹¤. Prometheusê°€ ì •ìƒ ì‘ë™ ì¤‘ì…ë‹ˆë‹¤."