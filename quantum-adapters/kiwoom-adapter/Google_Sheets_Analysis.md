# 구글 시트 크롤링 데이터 분석

## 📊 개요
구글 시트 종목분석 시스템에서 A1:K17 범위에서 크롤링하는 데이터를 분석하여 키움 API로 대체 가능한 데이터를 식별합니다.

## 🔍 크롤링 소스 분석

### 네이버 금융 (finance.naver.com)
**URL 패턴**: `https://finance.naver.com/item/main.naver?code={종목코드}`

**삼성전자(005930) 기준 추출 데이터:**
```
현재가: 71,500원
전일대비: +100원 (+0.14%)
거래량: 10,345,178주
시가총액: 423.2조원 (KOSPI 1위)
PER: 15.97
PBR: 1.23
ROE: 7.95%
배당수익률: 2.02%
외국인지분율: 50.56% (2,993,194,589주)
52주 고가/저가: 78,200 / 49,900원
상장구분: KOSPI
업종: 반도체와 반도체 장비
```

### FnGuide (comp.fnguide.com)
**URL 패턴**: `http://comp.fnguide.com/SVO2/asp/SVD_FinanceRatio.asp?pGB=1&gicode=A{종목코드}&cID=&MenuYn=Y&ReportGB=&NewMenuID=104&stkGb=701`

**재무비율 데이터 (최근 3개년):**

#### 수익성 지표
- ROE (자기자본이익률): 2021(13.9%) → 2022(17.1%) → 2023(4.1%)
- ROA (총자산이익률): 2021(9.9%) → 2022(12.7%) → 2023(3.4%) 
- ROIC (투자자본이익률): 2021(23.9%) → 2022(25.9%) → 2023(3.8%)

#### 안정성 지표
- 부채비율: 2021(39.9%) → 2022(26.4%) → 2023(25.4%)
- 유동비율: 2021(247.6%) → 2022(278.9%) → 2023(258.8%)

#### 성장성 지표
- 매출액증가율: 2021(18.1%) → 2022(8.1%) → 2023(-14.3%)

## 📋 A1:K17 셀 구조 추정

### A열: 기본 정보
- A1: 종목코드 (예: 005930)
- A2: 종목명 (예: 삼성전자)
- A3: 현재가 (네이버 크롤링)
- A4: 전일대비 (네이버 크롤링)

### B열: 거래 정보
- B1: 거래량 (네이버 크롤링)
- B2: 시가총액 (네이버 크롤링)
- B3: 52주 고가 (네이버 크롤링)
- B4: 52주 저가 (네이버 크롤링)

### C-E열: 재무 비율 (FnGuide)
- C1: PER (네이버 또는 FnGuide)
- C2: PBR (네이버 또는 FnGuide)
- C3: ROE (FnGuide)
- D1: ROA (FnGuide)
- D2: ROIC (FnGuide)
- E1: 부채비율 (FnGuide)
- E2: 유동비율 (FnGuide)

### F-H열: 성장성/수익성
- F1: 매출액증가율 (FnGuide)
- F2: 영업이익증가율 (FnGuide)
- G1: 배당수익률 (네이버)
- H1: 외국인지분율 (네이버)

### I-K열: 기술적 지표
- I1: RSI (계산 필요)
- J1: OBV (계산 필요)
- K1: 투자심리도 (계산 또는 크롤링)

## 🎯 분석 결과 요약

### 크롤링 의존도
1. **네이버 금융**: 실시간 주가, 거래량, 기본 재무비율
2. **FnGuide**: 상세 재무비율, 성장성 지표
3. **계산 지표**: RSI, OBV 등 기술적 지표

### 데이터 특성
- **실시간성**: 주가, 거래량 (네이버)
- **정확성**: 재무비율 (FnGuide)
- **계산 복잡도**: 기술적 지표 (자체 계산)

## 📝 키움 API 대체 가능성 평가

### 🟢 완전 대체 가능
- 현재가, 전일대비, 등락률
- 거래량, 시가총액  
- 52주 고가/저가
- 기본 재무비율 (PER, PBR)

### 🟡 부분 대체 가능  
- ROE, ROA (키움 API 재무정보 확인 필요)
- 외국인/기관 보유율 (키움 기관매매추이 API 활용)
- 배당 정보 (키움 배당 관련 API 확인 필요)

### 🔴 대체 어려움
- 상세 재무비율 (부채비율, 유동비율 등)
- 성장성 지표 (매출액증가율, 영업이익증가율)
- 업종 평균 대비 데이터

## 📈 다음 단계
1. 키움 API 상세 스펙 확인
2. 재무정보 관련 추가 API 탐색
3. 계산 가능한 지표들의 구현 방안 수립

---
*분석 일시: 2024-12-25*
*대상: 구글 시트 종목분석 시스템 A1:K17 범위*