# Google Sheets ì¢…ëª©ë¶„ì„ ì‹œìŠ¤í…œ â†’ Python êµ¬í˜„ ê³„íšì„œ

## ğŸ“Š Google Sheets ë¶„ì„ ì‹œìŠ¤í…œ ë¶„ì„ ê²°ê³¼

### ğŸ—ï¸ ì‹œìŠ¤í…œ êµ¬ì¡°
- **4ê°œ ì‹œíŠ¸**: ì¢…ëª©ë¶„ì„_ìë™, ì¢…ëª©ë¶„ì„_ìˆ˜ë™, ë¶„ì„ê²°ê³¼ëˆ„ì , ì „ì¢…ëª©ê¸°ë³¸ì •ë³´
- **ë¶„ì„ ëŒ€ìƒ**: ê°œë³„ ì¢…ëª© (í˜„ì¬ ì½”ë‚˜ì•„ì´ 052400 ë¶„ì„ í™•ì¸)
- **ìë™í™”**: GOOGLEFINANCE(), í¬ë¡¤ë§ í•¨ìˆ˜, Apps Script í™œìš©

### ğŸ¯ 4ê°œ ì˜ì—­ë³„ ì ìˆ˜ ì²´ê³„ (ì´ 14ì )

#### 1. ì¬ë¬´ ì˜ì—­ (3ì )
- **ë§¤ì¶œì•¡**: ì „ë…„ ëŒ€ë¹„ ì¦ê°€ìœ¨
- **ì˜ì—…ì´ìµ**: ì „ë…„ ëŒ€ë¹„ ì¦ê°€ìœ¨  
- **ì˜ì—…ì´ìµë¥ **: ì—…ì¢… í‰ê·  ëŒ€ë¹„
- **ë¶€ì±„ë¹„ìœ¨**: ì•ˆì „ì„± ì§€í‘œ
- **ìœ ë³´ìœ¨**: ë°°ë‹¹ ì—¬ë ¥

#### 2. ê¸°ìˆ  ì˜ì—­ (4ì )
- **RSI**: ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„ ì§€í‘œ
- **OBV**: ê±°ë˜ëŸ‰ ê¸°ë°˜ ì¶”ì„¸ ì§€í‘œ
- **íˆ¬ìì‹¬ë¦¬ë„**: ì‹œì¥ ì‹¬ë¦¬ ë°˜ì˜
- **ì´ë™í‰ê· ì„ **: ì¶”ì„¸ ë¶„ì„

#### 3. ê°€ê²© ì˜ì—­ (2ì )
- **ìµœê³ ê°€ ëŒ€ë¹„**: í˜„ì¬ ìœ„ì¹˜
- **ìµœì €ê°€ ëŒ€ë¹„**: ë°˜ë“± ì •ë„
- **ê°€ê²© ëª¨ë©˜í…€**: ìƒìŠ¹/í•˜ë½ ì¶”ì„¸

#### 4. ì¬ë£Œ ì˜ì—­ (5ì )
- **ë°°ë‹¹ë¥ **: ë°°ë‹¹ ìˆ˜ìµë¥ 
- **ì™¸êµ­ì¸ ë³´ìœ ìœ¨**: ì™¸êµ­ì¸ ê´€ì‹¬ë„
- **ê¸°ê´€ ìˆœë§¤ë§¤**: 60ì¼ ê¸°ì¤€
- **ê±°ë˜ëŸ‰**: í‰ê·  ëŒ€ë¹„ í™œì„±ë„
- **ì´ìë³´ìƒë°°ìœ¨**: ì¬ë¬´ ì•ˆì „ì„±

### ğŸ”¢ ì ìˆ˜í™” ë°©ì‹
- **ê° ì§€í‘œ**: -1ì  ~ +1ì  ë²”ìœ„
- **ìƒëŒ€ í‰ê°€**: ì—…ì¢… í‰ê· , ê²½ìŸì‚¬ ëŒ€ë¹„
- **ê°€ì¤‘ì¹˜**: ì˜ì—­ë³„ ì¤‘ìš”ë„ ë°˜ì˜
- **ì´ì  í•´ì„**: 
  - 10ì  ì´ìƒ: ë§¤ìˆ˜ ê³ ë ¤
  - 5-10ì : ê´€ì‹¬ ì¢…ëª©
  - 0-5ì : ë³´í†µ
  - 0ì  ë¯¸ë§Œ: ì£¼ì˜ í•„ìš”

## ğŸ Python ëª¨ë“ˆ ì„¤ê³„

### ğŸ“ ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
src/kiwoom_api/analysis/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ calculator.py      # ì§€í‘œ ê³„ì‚° ì—”ì§„
â”‚   â”œâ”€â”€ scorer.py          # ì ìˆ˜í™” ë¡œì§
â”‚   â””â”€â”€ models.py          # ë°ì´í„° ëª¨ë¸
â”œâ”€â”€ indicators/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ financial.py       # ì¬ë¬´ ì§€í‘œ ê³„ì‚°
â”‚   â”œâ”€â”€ technical.py       # ê¸°ìˆ ì  ì§€í‘œ (RSI, OBV ë“±)
â”‚   â”œâ”€â”€ price.py           # ê°€ê²© ê´€ë ¨ ì§€í‘œ
â”‚   â””â”€â”€ material.py        # ì¬ë£Œ ë¶„ì„
â”œâ”€â”€ crawlers/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ news_crawler.py    # ë‰´ìŠ¤ í¬ë¡¤ë§
â”‚   â”œâ”€â”€ disclosure_crawler.py  # ê³µì‹œ í¬ë¡¤ë§
â”‚   â””â”€â”€ market_crawler.py  # ì‹œì¥ ë°ì´í„°
â”œâ”€â”€ charts/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ generator.py       # ì°¨íŠ¸ ìƒì„±
â”‚   â””â”€â”€ templates.py       # ì°¨íŠ¸ í…œí”Œë¦¿
â””â”€â”€ api/
    â”œâ”€â”€ __init__.py
    â””â”€â”€ analysis_router.py # FastAPI ì—”ë“œí¬ì¸íŠ¸
```

### ğŸ”§ í•µì‹¬ ëª¨ë“ˆ ì„¤ê³„

#### 1. ì§€í‘œ ê³„ì‚° ì—”ì§„ (`calculator.py`)
```python
class IndicatorCalculator:
    def __init__(self, stock_code: str):
        self.stock_code = stock_code
        
    async def calculate_rsi(self, period: int = 14) -> float:
        """RSI ê³„ì‚°"""
        
    async def calculate_per(self) -> float:
        """PER ê³„ì‚°"""
        
    async def calculate_roe(self) -> float:
        """ROE ê³„ì‚°"""
        
    async def calculate_obv(self) -> float:
        """OBV ê³„ì‚°"""
```

#### 2. ì ìˆ˜í™” ì‹œìŠ¤í…œ (`scorer.py`)
```python
class AnalysisScorer:
    def score_rsi(self, rsi: float) -> float:
        """RSIë¥¼ -1~+1 ì ìˆ˜ë¡œ ë³€í™˜"""
        if rsi <= 30:
            return 1.0  # ê³¼ë§¤ë„ â†’ ë§¤ìˆ˜ ê¸°íšŒ
        elif rsi >= 70:
            return -1.0  # ê³¼ë§¤ìˆ˜ â†’ ë§¤ë„ ì‹ í˜¸
        else:
            return (50 - rsi) / 20  # ì„ í˜• ë³€í™˜
            
    def score_financial(self, indicators: dict) -> float:
        """ì¬ë¬´ ì§€í‘œ ì¢…í•© ì ìˆ˜"""
        
    def calculate_total_score(self, scores: dict) -> dict:
        """4ê°œ ì˜ì—­ ì´ì  ê³„ì‚°"""
```

#### 3. í¬ë¡¤ë§ ëª¨ë“ˆ (`crawlers/`)
```python
class NewsCrawler:
    async def get_stock_news(self, stock_code: str) -> List[dict]:
        """ì¢…ëª© ê´€ë ¨ ë‰´ìŠ¤ í¬ë¡¤ë§"""
        
class DisclosureCrawler:
    async def get_disclosures(self, stock_code: str) -> List[dict]:
        """ê³µì‹œ ì •ë³´ í¬ë¡¤ë§"""
        
class MarketCrawler:
    async def get_market_data(self, stock_code: str) -> dict:
        """ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘"""
```

#### 4. ì°¨íŠ¸ ìƒì„± (`charts/`)
```python
class ChartGenerator:
    def create_score_chart(self, scores: dict) -> str:
        """ì ìˆ˜ ë ˆì´ë” ì°¨íŠ¸ ìƒì„±"""
        
    def create_trend_chart(self, data: List[dict]) -> str:
        """ì¶”ì„¸ ì°¨íŠ¸ ìƒì„±"""
        
    def create_comparison_chart(self, stocks: List[str]) -> str:
        """ì¢…ëª© ë¹„êµ ì°¨íŠ¸"""
```

## ğŸš€ ë‹¨ê³„ë³„ êµ¬í˜„ ë¡œë“œë§µ

### 1ë‹¨ê³„: RSI ê³„ì‚° API â­ (ìµœìš°ì„ )
**ëª©í‘œ**: ê°€ì¥ ê°„ë‹¨í•œ ê¸°ìˆ ì  ì§€í‘œ í•˜ë‚˜ êµ¬í˜„
```
GET /api/analysis/rsi/{stock_code}
â†’ {"rsi": 65.2, "score": 0.3, "interpretation": "ì¤‘ë¦½"}
```

**êµ¬í˜„ ë²”ìœ„**:
- RSI ê³„ì‚° ë¡œì§
- í‚¤ì›€ ì¼ë´‰ ë°ì´í„° ì—°ë™
- ì ìˆ˜í™” (-1~+1)
- ì›¹ UI ì—°ë™

**ì†Œìš” ì‹œê°„**: 1-2ì‹œê°„

### 2ë‹¨ê³„: ì¬ë¬´ ì§€í‘œ ê³„ì‚°
**ëª©í‘œ**: PER, ROE, ë¶€ì±„ë¹„ìœ¨ ë“± ê¸°ë³¸ ì¬ë¬´ ì§€í‘œ

**êµ¬í˜„ ë²”ìœ„**:
- ì¬ë¬´ì œí‘œ ë°ì´í„° ìˆ˜ì§‘
- ì¬ë¬´ ì§€í‘œ ê³„ì‚° ê³µì‹
- ì—…ì¢… í‰ê·  ëŒ€ë¹„ ì ìˆ˜í™”

**ì†Œìš” ì‹œê°„**: 2-3ì‹œê°„

### 3ë‹¨ê³„: ê¸°ìˆ ì  ì§€í‘œ í™•ì¥
**ëª©í‘œ**: OBV, ì´ë™í‰ê· ì„ , íˆ¬ìì‹¬ë¦¬ë„

**êµ¬í˜„ ë²”ìœ„**:
- ë‹¤ì–‘í•œ ê¸°ìˆ ì  ì§€í‘œ êµ¬í˜„
- ì°¨íŠ¸ íŒ¨í„´ ë¶„ì„
- ì¶”ì„¸ ë¶„ì„ ë¡œì§

**ì†Œìš” ì‹œê°„**: 3-4ì‹œê°„

### 4ë‹¨ê³„: í¬ë¡¤ë§ ê¸°ëŠ¥
**ëª©í‘œ**: ë‰´ìŠ¤, ê³µì‹œ, ì™¸ë¶€ ë°ì´í„° ìˆ˜ì§‘

**êµ¬í˜„ ë²”ìœ„**:
- ë„¤ì´ë²„/ë‹¤ìŒ ë‰´ìŠ¤ í¬ë¡¤ë§
- ê³µì‹œ ì •ë³´ ìˆ˜ì§‘
- ì™¸êµ­ì¸/ê¸°ê´€ ë§¤ë§¤ ë™í–¥

**ì†Œìš” ì‹œê°„**: 4-5ì‹œê°„

### 5ë‹¨ê³„: ì°¨íŠ¸ ìƒì„±
**ëª©í‘œ**: ë¶„ì„ ê²°ê³¼ ì‹œê°í™”

**êµ¬í˜„ ë²”ìœ„**:
- ì ìˆ˜ ë ˆì´ë” ì°¨íŠ¸
- ì¶”ì„¸ ë¶„ì„ ì°¨íŠ¸
- ì¢…ëª© ë¹„êµ ì°¨íŠ¸

**ì†Œìš” ì‹œê°„**: 2-3ì‹œê°„

### 6ë‹¨ê³„: í†µí•© ë¶„ì„ ì‹œìŠ¤í…œ
**ëª©í‘œ**: 4ê°œ ì˜ì—­ ì¢…í•© ë¶„ì„

**êµ¬í˜„ ë²”ìœ„**:
- ì „ì²´ ì ìˆ˜ ê³„ì‚°
- ë§¤ìˆ˜/ë§¤ë„ ì‹ í˜¸ ìƒì„±
- ë¶„ì„ ë¦¬í¬íŠ¸ ìë™ ìƒì„±

**ì†Œìš” ì‹œê°„**: 3-4ì‹œê°„

### 7ë‹¨ê³„: ë‹¤ì¢…ëª© ë¶„ì„
**ëª©í‘œ**: ì—¬ëŸ¬ ì¢…ëª© ë™ì‹œ ë¶„ì„

**êµ¬í˜„ ë²”ìœ„**:
- ë°°ì¹˜ ì²˜ë¦¬ ì‹œìŠ¤í…œ
- ë­í‚¹ ì‹œìŠ¤í…œ
- í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„

**ì†Œìš” ì‹œê°„**: 4-5ì‹œê°„

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### ğŸ“š í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬
```python
# ë°ì´í„° ì²˜ë¦¬
pandas >= 1.5.0
numpy >= 1.24.0

# ê¸°ìˆ ì  ì§€í‘œ ê³„ì‚°
TA-Lib >= 0.4.25
pandas-ta >= 0.3.14

# í¬ë¡¤ë§
beautifulsoup4 >= 4.11.0
selenium >= 4.8.0
requests >= 2.28.0

# ì°¨íŠ¸ ìƒì„±
matplotlib >= 3.6.0
plotly >= 5.13.0
seaborn >= 0.12.0

# ë¹„ë™ê¸° ì²˜ë¦¬
aiohttp >= 3.8.0
asyncio-throttle >= 1.0.0

# ë°ì´í„° ì €ì¥
sqlite3 (ë‚´ì¥)
# ë˜ëŠ” PostgreSQL for production
```

### ğŸ”Œ FastAPI ì—°ë™

#### API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„
```python
# ê°œë³„ ì§€í‘œ ë¶„ì„
GET /api/analysis/rsi/{stock_code}
GET /api/analysis/per/{stock_code}  
GET /api/analysis/roe/{stock_code}

# ì˜ì—­ë³„ ë¶„ì„
GET /api/analysis/financial/{stock_code}
GET /api/analysis/technical/{stock_code}
GET /api/analysis/price/{stock_code}
GET /api/analysis/material/{stock_code}

# ì¢…í•© ë¶„ì„
GET /api/analysis/total/{stock_code}
POST /api/analysis/multiple
# Body: {"stocks": ["005930", "000660"]}

# ì°¨íŠ¸ ìƒì„±
GET /api/analysis/chart/{stock_code}/{chart_type}

# í¬ë¡¤ë§ ë°ì´í„°
GET /api/analysis/news/{stock_code}
GET /api/analysis/disclosure/{stock_code}
```

#### ì›¹ UI ì—°ë™
```javascript
// ë¶„ì„ ìš”ì²­
async function analyzeStock(stockCode) {
    const response = await fetch(`/api/analysis/total/${stockCode}`);
    const data = await response.json();
    
    // ê²°ê³¼ í‘œì‹œ
    updateAnalysisCard(data);
}

// ì°¨íŠ¸ í‘œì‹œ
async function showChart(stockCode, chartType) {
    const chartUrl = `/api/analysis/chart/${stockCode}/${chartType}`;
    document.getElementById('chart').innerHTML = 
        `<img src="${chartUrl}" alt="Analysis Chart">`;
}
```

## ğŸ“ˆ ë°ì´í„° íë¦„

### ë¶„ì„ í”„ë¡œì„¸ìŠ¤
```mermaid
graph TD
    A[ì¢…ëª© ì½”ë“œ ì…ë ¥] --> B[í‚¤ì›€ API ë°ì´í„° ìˆ˜ì§‘]
    B --> C[í¬ë¡¤ë§ ë°ì´í„° ìˆ˜ì§‘]
    C --> D[ì§€í‘œ ê³„ì‚°]
    D --> E[ì ìˆ˜í™”]
    E --> F[ì°¨íŠ¸ ìƒì„±]
    F --> G[ê²°ê³¼ ë°˜í™˜]
```

### ë°ì´í„° ì†ŒìŠ¤
1. **í‚¤ì›€ API**: ì£¼ê°€, ê±°ë˜ëŸ‰, ì¬ë¬´ ë°ì´í„°
2. **ì™¸ë¶€ í¬ë¡¤ë§**: ë‰´ìŠ¤, ê³µì‹œ, ì‹œì¥ ë°ì´í„°
3. **ê³„ì‚° ê²°ê³¼**: RSI, PER, ROE ë“± ì§€í‘œ
4. **ì ìˆ˜í™”**: Google Sheets ë¡œì§ ì ìš©

## ğŸ¯ ì„±ê³µ ì§€í‘œ

### 1ë‹¨ê³„ ì„±ê³µ ê¸°ì¤€
- [ ] RSI API ì‘ë‹µ ì‹œê°„ < 2ì´ˆ
- [ ] ê³„ì‚° ì •í™•ë„ ê²€ì¦
- [ ] ì›¹ UIì—ì„œ ì •ìƒ í‘œì‹œ

### ìµœì¢… ì„±ê³µ ê¸°ì¤€  
- [ ] 4ê°œ ì˜ì—­ ëª¨ë“  ì§€í‘œ ê³„ì‚°
- [ ] Google Sheetsì™€ ë™ì¼í•œ ì ìˆ˜
- [ ] ë‹¤ì¢…ëª© ë™ì‹œ ë¶„ì„ ì§€ì›
- [ ] ì°¨íŠ¸ ì‹œê°í™” ì™„ì„±
- [ ] ë§¤ìˆ˜/ë§¤ë„ ì‹ í˜¸ ìƒì„±

## ğŸ“ ê°œë°œ ìš°ì„ ìˆœìœ„

**ğŸ”¥ ì¦‰ì‹œ ì‹œì‘**: RSI ê³„ì‚° API
**âš¡ ë‹¤ìŒ ë‹¨ê³„**: ì¬ë¬´ ì§€í‘œ (PER, ROE)
**ğŸ“Š ì¤‘ê¸° ëª©í‘œ**: í¬ë¡¤ë§ + ì°¨íŠ¸
**ğŸ¯ ìµœì¢… ëª©í‘œ**: í†µí•© ë¶„ì„ ì‹œìŠ¤í…œ

---

*ì´ ê³„íšì„œëŠ” Google Sheetsì˜ ì¢…ëª©ë¶„ì„ ì‹œìŠ¤í…œì„ Pythonìœ¼ë¡œ ë‹¨ê³„ì ìœ¼ë¡œ êµ¬í˜„í•˜ê¸° ìœ„í•œ ë¡œë“œë§µì…ë‹ˆë‹¤. ê° ë‹¨ê³„ë³„ë¡œ ì‘ì€ ê¸°ëŠ¥ë¶€í„° ì™„ì„±í•´ ë‚˜ê°€ë©°, ìµœì¢…ì ìœ¼ë¡œëŠ” ì‹¤ì‹œê°„ ì¢…ëª© ë¶„ì„ ì‹œìŠ¤í…œì„ ì™„ì„±í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.*